<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>æ•¸å­—æ¯”å¤§å°ç·´ç¿’</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root {
      --bg: #f5f5f7;
      --card-bg: #fafafe;
      --border: #d0d0e0;
      --text: #222;
      --subtext: #555;
      --accent: #4f46e5;
      --accent-soft: #e0e7ff;
      --range-border: #ccc;
    }

    body.dark {
      --bg: #121212;
      --card-bg: #1f1f26;
      --border: #3a3a4a;
      --text: #f7f7ff;
      --subtext: #b0b0c0;
      --accent: #a5b4fc;
      --accent-soft: #312e81;
      --range-border: #555;
    }

    * {
      box-sizing: border-box;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
    }

    body {
      margin: 0;
      background: var(--bg);
      color: var(--text);
    }

    .app {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      padding: 10px 12px 12px;
    }

    .app-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding-bottom: 4px;
    }

    .title {
      font-size: 1rem;
      font-weight: 700;
    }

    .subtitle {
      font-size: 0.75rem;
      color: var(--subtext);
    }

    .dark-toggle {
      padding: 3px 10px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: transparent;
      color: var(--subtext);
      font-size: 0.75rem;
      cursor: pointer;
      white-space: nowrap;
    }

    /* ä¸­é–“å¤§æ•¸å­—æ­£æ–¹å½¢æ ¼å­å€ */
    .numbers-row {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: clamp(20px, 6vw, 70px); /* ä¸­é–“è·é›¢åŠ å¤§ï¼Œé¿å…èª¤è§¸ */
      margin: 4px 0 8px;
    }

    .number-card {
      flex: 0 0 auto;
      width: min(40vmin, 42vw); /* ä¾è¢å¹•è‡ªå‹•ç¸®æ”¾ */
      aspect-ratio: 1 / 1;      /* æ­£æ–¹å½¢ */
      border-radius: 16px;
      border: 3px solid var(--border);
      background: var(--card-bg);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: transform 0.08s ease, box-shadow 0.08s ease,
        border-color 0.08s ease, background 0.1s;
    }

    .number-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.18);
      border-color: var(--accent);
      background: var(--accent-soft);
    }

    .number-value {
      font-size: clamp(3rem, 10vw, 5.5rem);
      font-weight: 700;
    }

    /* ä¸‹æ–¹æ§åˆ¶åˆ— */
    .controls-row {
      border-top: 1px dashed var(--border);
      padding-top: 6px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
      font-size: 0.85rem;
    }

    .mode-group,
    .range-group {
      display: flex;
      align-items: center;
      flex-wrap: wrap;
      gap: 6px;
    }

    .mode-group {
      flex: 1 1 220px;
    }

    .range-group {
      flex: 1 1 260px;
      justify-content: flex-end;
    }

    .controls-label {
      font-weight: 600;
      white-space: nowrap;
    }

    .btn-pill {
      border-radius: 10px;
      padding: 4px 10px;
      border: 2px solid var(--border);
      background: transparent;
      cursor: pointer;
      font-size: 0.9rem;
      font-weight: 700;
      transition: background 0.1s, border-color 0.1s, color 0.1s,
        transform 0.08s;
      white-space: nowrap;
    }

    .btn-pill.active {
      background: var(--accent-soft);
      border-color: var(--accent);
      color: var(--accent);
      transform: translateY(-1px);
    }

    .btn-pill.disabled {
      opacity: 0.4;
      border-style: dashed;
      pointer-events: none;
    }

    .mode-hint {
      font-size: 0.78rem;
      color: var(--subtext);
      white-space: nowrap;
    }

    .range-group input[type="number"] {
      width: 70px;
      padding: 3px 5px;
      border-radius: 6px;
      border: 1px solid var(--range-border);
      font-size: 0.85rem;
      background: transparent;
      color: var(--text);
    }

    .range-group button {
      padding: 3px 8px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      font-size: 0.78rem;
      background: var(--accent);
      color: #fff;
      white-space: nowrap;
    }

    .range-tip {
      font-size: 0.75rem;
      color: var(--subtext);
      white-space: nowrap;
    }

    @media (max-width: 640px) {
      .app {
        padding: 8px;
      }

      .numbers-row {
        gap: clamp(16px, 8vw, 40px);
      }

      .controls-row {
        flex-direction: column;
        align-items: stretch;
      }

      .range-group {
        justify-content: flex-start;
      }
    }

    @media (orientation: landscape) and (max-height: 480px) {
      .number-card {
        width: min(35vmin, 32vw);
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <div class="app-header">
      <div>
        <div class="title">æ•¸å­—æ¯”å¤§å°ç·´ç¿’</div>
        <div class="subtitle">å…©ç¨®ç©æ³•ï¼šæ¯”å¤§å° / å’ŒåŸºæº–æ•¸æ¯”</div>
      </div>
      <button class="dark-toggle" id="darkToggle">ğŸŒ™ æš—è‰²æ¨¡å¼</button>
    </div>

    <div class="numbers-row">
      <div class="number-card" id="cardLeft">
        <div class="number-value" id="num1">â€“</div>
      </div>
      <div class="number-card" id="cardRight">
        <div class="number-value" id="num2">â€“</div>
      </div>
    </div>

    <div class="controls-row">
      <div class="mode-group">
        <span class="controls-label">ç©æ³•ï¼š</span>
        <button class="btn-pill active" id="gameTwo">å…©æ•¸æ¯”</button>
        <button class="btn-pill" id="gameBase">æ¯”åŸºæº–</button>

        <span class="controls-label">ç›®æ¨™ï¼š</span>
        <button class="btn-pill" id="modeBig">å¤§</button>
        <button class="btn-pill" id="modeSmall">å°</button>

        <span class="mode-hint" id="modeHint">
          å…©æ•¸æ¯”å¤§å°ï¼šç›®å‰ <strong>å¤§</strong>ï¼ˆé»é¸è¼ƒå¤§çš„æ•¸å­—ï¼‰
        </span>
      </div>

      <div class="range-group">
        <span class="controls-label">ç¯„åœï¼š</span>
        <input type="number" id="minVal" value="0" />
        <span>ï½</span>
        <input type="number" id="maxVal" value="20" />
        <button id="updateRange">æ›´æ–°</button>

        <span class="controls-label">åŸºæº–ï¼š</span>
        <input type="number" id="baseVal" value="50" />

        <span class="range-tip" id="rangeTip">ç›®å‰ï¼š0 ï½ 20</span>
      </div>
    </div>
  </div>

  <script>
    window.onload = function () {
      var num1El = document.getElementById("num1");
      var num2El = document.getElementById("num2");
      var cardLeft = document.getElementById("cardLeft");
      var cardRight = document.getElementById("cardRight");

      // ç©æ³• / æ¨¡å¼
      var gameTwoBtn = document.getElementById("gameTwo");
      var gameBaseBtn = document.getElementById("gameBase");
      var modeBigBtn = document.getElementById("modeBig");
      var modeSmallBtn = document.getElementById("modeSmall");
      var modeHint = document.getElementById("modeHint");

      // ç¯„åœ & åŸºæº–
      var minInput = document.getElementById("minVal");
      var maxInput = document.getElementById("maxVal");
      var baseInput = document.getElementById("baseVal");
      var rangeTip = document.getElementById("rangeTip");
      var updateRangeBtn = document.getElementById("updateRange");

      // æš—è‰²æ¨¡å¼
      var darkToggle = document.getElementById("darkToggle");

      var min = 0;
      var max = 20;
      var gameType = "two"; // "two" æˆ– "base"
      var mode = "big";     // "big" æˆ– "small"ï¼ˆåªåœ¨ two æ¨¡å¼æœ‰ç”¨ï¼‰

      var currentNum1 = null; // å·¦æ ¼
      var currentNum2 = null; // å³æ ¼
      var lock = false;

      // Web Audio éŸ³æ•ˆ
      var AudioCtx = window.AudioContext || window.webkitAudioContext;
      var audioCtx = new AudioCtx();

      function ensureAudioContext() {
        if (audioCtx.state === "suspended") {
          audioCtx.resume();
        }
      }

      // ç­”å°ï¼šä¸Šå‡ä¸‰éŸ³ã€Œå®å®å®ã€
      function playCorrectSound() {
        ensureAudioContext();
        var now = audioCtx.currentTime;
        var osc = audioCtx.createOscillator();
        var gain = audioCtx.createGain();

        osc.type = "triangle";
        osc.connect(gain);
        gain.connect(audioCtx.destination);

        gain.gain.setValueAtTime(0.3, now);
        gain.gain.exponentialRampToValueAtTime(0.001, now + 0.6);

        osc.frequency.setValueAtTime(660, now);
        osc.frequency.setValueAtTime(880, now + 0.2);
        osc.frequency.setValueAtTime(1040, now + 0.4);

        osc.start(now);
        osc.stop(now + 0.6);
      }

      // ç­”éŒ¯ï¼šä½æ²‰å¾€ä¸‹æ‰ã€Œå—¡â”€â”€ã€
      function playWrongSound() {
        ensureAudioContext();
        var now = audioCtx.currentTime;
        var osc = audioCtx.createOscillator();
        var gain = audioCtx.createGain();

        osc.type = "sawtooth";
        osc.connect(gain);
        gain.connect(audioCtx.destination);

        gain.gain.setValueAtTime(0.25, now);
        gain.gain.exponentialRampToValueAtTime(0.001, now + 0.5);

        osc.frequency.setValueAtTime(260, now);
        osc.frequency.linearRampToValueAtTime(120, now + 0.5);

        osc.start(now);
        osc.stop(now + 0.5);
      }

      function getRandomIntInclusive(a, b) {
        var mi = Math.ceil(a);
        var ma = Math.floor(b);
        return Math.floor(Math.random() * (ma - mi + 1)) + mi;
      }

      function updateModeHint() {
        if (gameType === "two") {
          if (mode === "big") {
            modeHint.innerHTML =
              'å…©æ•¸æ¯”å¤§å°ï¼šç›®å‰ <strong>å¤§</strong>ï¼ˆé»é¸è¼ƒå¤§çš„æ•¸å­—ï¼‰';
          } else {
            modeHint.innerHTML =
              'å…©æ•¸æ¯”å¤§å°ï¼šç›®å‰ <strong>å°</strong>ï¼ˆé»é¸è¼ƒå°çš„æ•¸å­—ï¼‰';
          }
        } else {
          modeHint.innerHTML =
            'å’ŒåŸºæº–æ•¸æ¯”ï¼šå·¦æ ¼ç‚ºåŸºæº–ï¼Œè‹¥å³é‚Šè¶…éåŸºæº–å°±é»å³æ ¼ï¼Œå¦å‰‡é»å·¦æ ¼ã€‚';
        }
      }

      function updateButtonsUI() {
        // ç©æ³•æŒ‰éˆ•
        if (gameType === "two") {
          gameTwoBtn.classList.add("active");
          gameBaseBtn.classList.remove("active");
        } else {
          gameBaseBtn.classList.add("active");
          gameTwoBtn.classList.remove("active");
        }

        // å¤§ / å° æŒ‰éˆ•
        if (mode === "big") {
          modeBigBtn.classList.add("active");
          modeSmallBtn.classList.remove("active");
        } else {
          modeSmallBtn.classList.add("active");
          modeBigBtn.classList.remove("active");
        }

        // åœ¨åŸºæº–æ¨¡å¼æ™‚ï¼Œå¤§ï¼å°åªæ˜¯ã€Œé—œé–‰ã€ç‹€æ…‹ï¼ˆä¸èƒ½é»ï¼‰
        if (gameType === "two") {
          modeBigBtn.classList.remove("disabled");
          modeSmallBtn.classList.remove("disabled");
        } else {
          modeBigBtn.classList.add("disabled");
          modeSmallBtn.classList.add("disabled");
        }

        updateModeHint();
      }

      function generateQuestion() {
        lock = false;

        if (gameType === "two") {
          // å…©æ•¸æ¯”å¤§å°ï¼šå·¦å³éƒ½æ˜¯éš¨æ©Ÿæ•¸
          var a = getRandomIntInclusive(min, max);
          var b = getRandomIntInclusive(min, max);

          if (max > min) {
            while (a === b) {
              a = getRandomIntInclusive(min, max);
              b = getRandomIntInclusive(min, max);
            }
          }

          currentNum1 = a;
          currentNum2 = b;
          num1El.textContent = a;
          num2El.textContent = b;
        } else {
          // å’ŒåŸºæº–æ•¸æ¯”ï¼šå·¦é‚ŠåŸºæº–ï¼Œå³é‚Šéš¨æ©Ÿæ•¸
          var base = Number(baseInput.value);
          if (isNaN(base)) {
            base = min;
            baseInput.value = base;
          }

          var r = getRandomIntInclusive(min, max);
          // å¯ä»¥å…è¨±å’ŒåŸºæº–ä¸€æ¨£ï¼Œè®“å­¸ç”Ÿç·´ç¿’ã€Œæ²’æœ‰è¶…éã€
          currentNum1 = base; // å·¦ï¼šåŸºæº–
          currentNum2 = r;    // å³ï¼šé¡Œç›®æ•¸å­—

          num1El.textContent = base;
          num2El.textContent = r;
        }
      }

      function checkAnswer(chosenSide) {
        if (lock) return;
        lock = true;

        var chosenValue =
          chosenSide === "left" ? currentNum1 : currentNum2;
        var otherValue =
          chosenSide === "left" ? currentNum2 : currentNum1;

        var isCorrect = false;

        if (gameType === "two") {
          // å…©æ•¸æ¯”å¤§å°
          var shouldPickBigger = mode === "big";
          isCorrect = shouldPickBigger
            ? chosenValue > otherValue
            : chosenValue < otherValue;
        } else {
          // å’ŒåŸºæº–æ•¸æ¯”ï¼šå·¦ = åŸºæº–ï¼Œå³ = é¡Œç›®
          var base = currentNum1;
          var randomNum = currentNum2;
          if (chosenSide === "right") {
            // å­¸ç”Ÿèªç‚ºã€Œæœ‰è¶…éåŸºæº–ã€
            isCorrect = randomNum > base;
          } else {
            // å­¸ç”Ÿèªç‚ºã€Œæ²’æœ‰è¶…éåŸºæº–ã€
            isCorrect = randomNum <= base;
          }
        }

        if (isCorrect) {
          playCorrectSound();
        } else {
          playWrongSound();
        }

        setTimeout(generateQuestion, 450);
      }

      cardLeft.onclick = function () {
        checkAnswer("left");
      };
      cardRight.onclick = function () {
        checkAnswer("right");
      };

      // ç©æ³•åˆ‡æ›
      gameTwoBtn.onclick = function () {
        gameType = "two";
        updateButtonsUI();
        generateQuestion();
      };

      gameBaseBtn.onclick = function () {
        gameType = "base";
        updateButtonsUI();
        generateQuestion();
      };

      // å¤§ / å° æ¨¡å¼ï¼ˆåªåœ¨ å…©æ•¸æ¯” å¤§å° æœ‰ç”¨ï¼‰
      modeBigBtn.onclick = function () {
        if (gameType !== "two") return;
        mode = "big";
        updateButtonsUI();
      };

      modeSmallBtn.onclick = function () {
        if (gameType !== "two") return;
        mode = "small";
        updateButtonsUI();
      };

      // æ›´æ–°ç¯„åœ
      updateRangeBtn.onclick = function () {
        var newMin = Number(minInput.value);
        var newMax = Number(maxInput.value);

        if (isNaN(newMin) || isNaN(newMax)) {
          alert("è«‹è¼¸å…¥æ­£ç¢ºçš„æ•¸å­—ã€‚");
          return;
        }
        if (newMin > newMax) {
          alert("æœ€å°å€¼ä¸èƒ½æ¯”æœ€å¤§å€¼å¤§ï¼");
          return;
        }

        min = newMin;
        max = newMax;
        rangeTip.textContent = "ç›®å‰ï¼š" + min + " ï½ " + max;
        generateQuestion();
      };

      // æš—è‰²æ¨¡å¼
      darkToggle.onclick = function () {
        document.body.classList.toggle("dark");
      };

      // åˆå§‹åŒ– UI & ç¬¬ä¸€é¡Œ
      updateButtonsUI();
      generateQuestion();
    };
  </script>
</body>
</html>
